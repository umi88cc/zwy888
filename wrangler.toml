name = "umi-blog"
main = "src/worker.js"
compatibility_date = "2026-01-30"

# --- 路由配置 (Route) ---
# 拦截所有访问 umi88.cc 的请求交给 Worker 处理
[[routes]]
pattern = "umi88.cc/*"
custom_domain = true

[[routes]]
pattern = "www.umi88.cc/*"
custom_domain = true

# --- 1. 数据库绑定 (D1) ---
# 用于存文章、用户、订单核心数据
[[d1_databases]]
binding = "DB"
database_name = "zwy888"
database_id = "194ecc7d-9b50-44b8-b4f9-2873913ade0c"

# --- 2. 缓存绑定 (KV) ---
# 用于存网站全局配置(菜单/备案号)、黑名单IP、验证码
[[kv_namespaces]]
binding = "KV"
id = "690d2289da634615bcf17c078c23d475"

# --- 3. 图片存储绑定 (R2) ---
# 你的图片桶：zwy888
[[r2_buckets]]
binding = "IMG_BUCKET"
bucket_name = "zwy888"

# --- 4. 环境变量 (公开) ---
[vars]
# 你的账户ID，用于拼接 S3 API (代码中可能用到)
R2_ACCOUNT_ID = "62581a5acbb0f2b76a2c28dd4169f14c" 
# 允许上传图片的后缀
ALLOWED_EXTENSIONS = "jpg,jpeg,png,gif,webp"

# --- 注意：敏感密钥不写在这里，使用 wrangler secret put 命令上传 ---
